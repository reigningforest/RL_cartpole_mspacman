nohup: ignoring input
CUDA is available. Using GPU: NVIDIA RTX A6000
Using device: cuda:4
/nfs/home/kek6109/.conda/envs/rl_1/lib/python3.10/site-packages/gymnasium/envs/registration.py:512: DeprecationWarning: [33mWARN: The environment MsPacman-v0 is out of date. You should consider upgrading to version `v4`.[0m
  logger.deprecation(
A.L.E: Arcade Learning Environment (version 0.11.2+ecc1138)
[Powered by Stella]
Action space size: 9
Starting training...
Learning will start after 5000 steps...
Episode 100/6000 | Reward: 230.0 | Avg(100): 245.30 | Steps: 678 | Epsilon: 0.9383 | Global Step: 67300
  *** New best model saved with avg reward: 245.30 ***
Episode 200/6000 | Reward: 210.0 | Avg(100): 255.90 | Steps: 628 | Epsilon: 0.8731 | Global Step: 133158
  *** New best model saved with avg reward: 255.90 ***
Episode 300/6000 | Reward: 270.0 | Avg(100): 266.10 | Steps: 747 | Epsilon: 0.8071 | Global Step: 199825
  *** New best model saved with avg reward: 266.10 ***
Episode 400/6000 | Reward: 670.0 | Avg(100): 295.40 | Steps: 889 | Epsilon: 0.7410 | Global Step: 266569
  *** New best model saved with avg reward: 295.40 ***
Episode 500/6000 | Reward: 260.0 | Avg(100): 287.70 | Steps: 573 | Epsilon: 0.6750 | Global Step: 333294
Episode 600/6000 | Reward: 310.0 | Avg(100): 337.40 | Steps: 668 | Epsilon: 0.6066 | Global Step: 402367
  *** New best model saved with avg reward: 337.40 ***
Episode 700/6000 | Reward: 290.0 | Avg(100): 339.60 | Steps: 692 | Epsilon: 0.5408 | Global Step: 468795
  *** New best model saved with avg reward: 339.60 ***
Episode 800/6000 | Reward: 290.0 | Avg(100): 369.30 | Steps: 793 | Epsilon: 0.4706 | Global Step: 539788
  *** New best model saved with avg reward: 369.30 ***
Episode 900/6000 | Reward: 630.0 | Avg(100): 384.60 | Steps: 819 | Epsilon: 0.4028 | Global Step: 608262
  *** New best model saved with avg reward: 384.60 ***
Episode 1000/6000 | Reward: 380.0 | Avg(100): 506.70 | Steps: 629 | Epsilon: 0.3270 | Global Step: 684756
  *** New best model saved with avg reward: 506.70 ***
  Checkpoint saved to: models/mspacman_dqn_episode_1000.pth
Episode 1100/6000 | Reward: 220.0 | Avg(100): 560.20 | Steps: 386 | Epsilon: 0.2526 | Global Step: 759956
  *** New best model saved with avg reward: 560.20 ***
Episode 1200/6000 | Reward: 290.0 | Avg(100): 642.10 | Steps: 518 | Epsilon: 0.1719 | Global Step: 841487
  *** New best model saved with avg reward: 642.10 ***
Episode 1300/6000 | Reward: 250.0 | Avg(100): 683.10 | Steps: 430 | Epsilon: 0.0905 | Global Step: 923735
  *** New best model saved with avg reward: 683.10 ***
   [Step 1000000] Learning rate updated to: 0.000090
Episode 1400/6000 | Reward: 480.0 | Avg(100): 759.70 | Steps: 683 | Epsilon: 0.0100 | Global Step: 1008434
  *** New best model saved with avg reward: 759.70 ***
Episode 1500/6000 | Reward: 470.0 | Avg(100): 870.90 | Steps: 700 | Epsilon: 0.0100 | Global Step: 1097937
  *** New best model saved with avg reward: 870.90 ***
Episode 1600/6000 | Reward: 2140.0 | Avg(100): 894.30 | Steps: 1052 | Epsilon: 0.0100 | Global Step: 1188425
  *** New best model saved with avg reward: 894.30 ***
Episode 1700/6000 | Reward: 610.0 | Avg(100): 860.10 | Steps: 685 | Epsilon: 0.0100 | Global Step: 1272068
Episode 1800/6000 | Reward: 600.0 | Avg(100): 848.60 | Steps: 678 | Epsilon: 0.0100 | Global Step: 1355215
Episode 1900/6000 | Reward: 2370.0 | Avg(100): 945.00 | Steps: 1097 | Epsilon: 0.0100 | Global Step: 1442459
  *** New best model saved with avg reward: 945.00 ***
Episode 2000/6000 | Reward: 1160.0 | Avg(100): 925.50 | Steps: 1253 | Epsilon: 0.0100 | Global Step: 1529205
  Checkpoint saved to: models/mspacman_dqn_episode_2000.pth
Episode 2100/6000 | Reward: 600.0 | Avg(100): 863.90 | Steps: 669 | Epsilon: 0.0100 | Global Step: 1612445
Episode 2200/6000 | Reward: 1760.0 | Avg(100): 952.20 | Steps: 1036 | Epsilon: 0.0100 | Global Step: 1698254
  *** New best model saved with avg reward: 952.20 ***
Episode 2300/6000 | Reward: 1400.0 | Avg(100): 881.00 | Steps: 923 | Epsilon: 0.0100 | Global Step: 1784258
Episode 2400/6000 | Reward: 790.0 | Avg(100): 835.40 | Steps: 905 | Epsilon: 0.0100 | Global Step: 1868763
Episode 2500/6000 | Reward: 670.0 | Avg(100): 931.20 | Steps: 642 | Epsilon: 0.0100 | Global Step: 1956215
   [Step 2000000] Learning rate updated to: 0.000081
Episode 2600/6000 | Reward: 650.0 | Avg(100): 938.40 | Steps: 605 | Epsilon: 0.0100 | Global Step: 2040535
Episode 2700/6000 | Reward: 2700.0 | Avg(100): 935.90 | Steps: 1189 | Epsilon: 0.0100 | Global Step: 2126555
Episode 2800/6000 | Reward: 1250.0 | Avg(100): 961.70 | Steps: 1093 | Epsilon: 0.0100 | Global Step: 2211881
  *** New best model saved with avg reward: 961.70 ***
Episode 2900/6000 | Reward: 730.0 | Avg(100): 878.70 | Steps: 785 | Epsilon: 0.0100 | Global Step: 2295139
Episode 3000/6000 | Reward: 650.0 | Avg(100): 897.10 | Steps: 649 | Epsilon: 0.0100 | Global Step: 2374417
  Checkpoint saved to: models/mspacman_dqn_episode_3000.pth
Episode 3100/6000 | Reward: 1120.0 | Avg(100): 830.50 | Steps: 850 | Epsilon: 0.0100 | Global Step: 2451996
Episode 3200/6000 | Reward: 750.0 | Avg(100): 886.00 | Steps: 724 | Epsilon: 0.0100 | Global Step: 2533002
Episode 3300/6000 | Reward: 440.0 | Avg(100): 883.60 | Steps: 565 | Epsilon: 0.0100 | Global Step: 2615732
Episode 3400/6000 | Reward: 1450.0 | Avg(100): 864.80 | Steps: 889 | Epsilon: 0.0100 | Global Step: 2697537
Episode 3500/6000 | Reward: 1150.0 | Avg(100): 894.10 | Steps: 847 | Epsilon: 0.0100 | Global Step: 2780621
Episode 3600/6000 | Reward: 700.0 | Avg(100): 901.80 | Steps: 684 | Epsilon: 0.0100 | Global Step: 2866401
Episode 3700/6000 | Reward: 660.0 | Avg(100): 906.50 | Steps: 685 | Epsilon: 0.0100 | Global Step: 2948990
   [Step 3000000] Learning rate updated to: 0.000073
Episode 3800/6000 | Reward: 450.0 | Avg(100): 960.70 | Steps: 522 | Epsilon: 0.0100 | Global Step: 3034302
Episode 3900/6000 | Reward: 660.0 | Avg(100): 1016.80 | Steps: 636 | Epsilon: 0.0100 | Global Step: 3123759
  *** New best model saved with avg reward: 1016.80 ***
Episode 4000/6000 | Reward: 720.0 | Avg(100): 953.90 | Steps: 846 | Epsilon: 0.0100 | Global Step: 3206661
  Checkpoint saved to: models/mspacman_dqn_episode_4000.pth
Episode 4100/6000 | Reward: 1420.0 | Avg(100): 995.50 | Steps: 1286 | Epsilon: 0.0100 | Global Step: 3290987
Episode 4200/6000 | Reward: 410.0 | Avg(100): 903.00 | Steps: 486 | Epsilon: 0.0100 | Global Step: 3372713
Episode 4300/6000 | Reward: 960.0 | Avg(100): 949.00 | Steps: 849 | Epsilon: 0.0100 | Global Step: 3457222
Episode 4400/6000 | Reward: 650.0 | Avg(100): 977.00 | Steps: 669 | Epsilon: 0.0100 | Global Step: 3538241
Episode 4500/6000 | Reward: 640.0 | Avg(100): 989.80 | Steps: 680 | Epsilon: 0.0100 | Global Step: 3625974
Episode 4600/6000 | Reward: 830.0 | Avg(100): 977.20 | Steps: 812 | Epsilon: 0.0100 | Global Step: 3711469
Episode 4700/6000 | Reward: 1160.0 | Avg(100): 1037.20 | Steps: 989 | Epsilon: 0.0100 | Global Step: 3800576
  *** New best model saved with avg reward: 1037.20 ***
Episode 4800/6000 | Reward: 800.0 | Avg(100): 1035.10 | Steps: 847 | Epsilon: 0.0100 | Global Step: 3888540
Episode 4900/6000 | Reward: 1080.0 | Avg(100): 992.40 | Steps: 733 | Epsilon: 0.0100 | Global Step: 3970947
   [Step 4000000] Learning rate updated to: 0.000066
Episode 5000/6000 | Reward: 1750.0 | Avg(100): 1084.40 | Steps: 1125 | Epsilon: 0.0100 | Global Step: 4061613
  *** New best model saved with avg reward: 1084.40 ***
  Checkpoint saved to: models/mspacman_dqn_episode_5000.pth
Episode 5100/6000 | Reward: 1250.0 | Avg(100): 1089.30 | Steps: 1175 | Epsilon: 0.0100 | Global Step: 4151252
  *** New best model saved with avg reward: 1089.30 ***
Episode 5200/6000 | Reward: 1430.0 | Avg(100): 1036.80 | Steps: 1193 | Epsilon: 0.0100 | Global Step: 4237130
Episode 5300/6000 | Reward: 840.0 | Avg(100): 1045.50 | Steps: 839 | Epsilon: 0.0100 | Global Step: 4326511
Episode 5400/6000 | Reward: 1210.0 | Avg(100): 979.20 | Steps: 888 | Epsilon: 0.0100 | Global Step: 4407457
Episode 5500/6000 | Reward: 1530.0 | Avg(100): 1036.10 | Steps: 1013 | Epsilon: 0.0100 | Global Step: 4497771
Episode 5600/6000 | Reward: 550.0 | Avg(100): 1231.40 | Steps: 574 | Epsilon: 0.0100 | Global Step: 4591629
  *** New best model saved with avg reward: 1231.40 ***
Episode 5700/6000 | Reward: 1030.0 | Avg(100): 1254.40 | Steps: 738 | Epsilon: 0.0100 | Global Step: 4688341
  *** New best model saved with avg reward: 1254.40 ***
Episode 5800/6000 | Reward: 1080.0 | Avg(100): 1195.20 | Steps: 960 | Epsilon: 0.0100 | Global Step: 4784948
Episode 5900/6000 | Reward: 1090.0 | Avg(100): 1340.20 | Steps: 958 | Epsilon: 0.0100 | Global Step: 4884882
  *** New best model saved with avg reward: 1340.20 ***
Episode 6000/6000 | Reward: 1170.0 | Avg(100): 1250.90 | Steps: 815 | Epsilon: 0.0100 | Global Step: 4978876
  Checkpoint saved to: models/mspacman_dqn_episode_6000.pth
Training finished.
Final model saved to: models/mspacman_dqn_final.pth

Loading best model from models/mspacman_dqn_best.pth for evaluation...
Running final evaluation for 500 episodes...
  Evaluation episode 100/500 completed
  Evaluation episode 200/500 completed
  Evaluation episode 300/500 completed
  Evaluation episode 400/500 completed
  Evaluation episode 500/500 completed

--- Evaluation Results (using BEST model) ---
Mean Reward: 1275.12
Standard Deviation: 419.55
Plot 1 saved to: plots/mspacman_v0_q_values.png
Plot 2 saved to: plots/mspacman_v0_rewards.png
Plot 3 saved to: plots/mspacman_v0_eval_histogram.png
